# Feature Specification: Waitlist and Makeup Class System

**Feature Branch**: `003-waitlist-and-makeup`
**Created**: 2025-10-27
**Status**: Draft
**MVP**: MVP-2B
**Dependencies**: MVP-2A (002-course-display-and-booking)
**Input**: "Build a waitlist queue system where parents can join a waitlist when a course is full, receive notifications when a spot opens up, and manage makeup classes after requesting leave."

## User Scenarios & Testing *(mandatory)*

### User Story 1 - 加入候补队列 (Priority: P1)

当课程已满员时,家长可以点击"加入候补"按钮,加入该课程的候补队列。系统支持动态候补容量管理(默认8人,可按课程类型调整),按FIFO原则管理。"长期排队"是指固定班名额已满时用户加入的候补队列，类似于高铁票的"候补"机制。

**Why this priority**: 候补功能是课程预约系统的重要补充,直接提升用户满意度和课程满员率,是核心体验功能。

**Independent Test**: 对满员课程点击"加入候补",验证是否成功加入队列,位置显示准确。

**Acceptance Scenarios**:

1. **Given** 课程已满员(如6/6人), **When** 用户查看课程详情, **Then** 显示"已满员"标签和"加入候补"按钮
2. **Given** 用户点击"加入候补", **When** 提交申请, **Then** 显示"已加入候补队列"Toast,按钮变为"已候补"(不可再点击)
3. **Given** 候补队列未满(如3/8人), **When** 用户加入, **Then** 成功加入,显示"您是第4位候补"
4. **Given** 候补队列已满(8/8人), **When** 用户尝试加入, **Then** 提示"候补队列已满,请选择其他课程"
5. **Given** 用户已加入候补, **When** 再次查看该课程, **Then** 显示"已候补"状态,提供"取消候补"按钮
6. **Given** 课程为热门课程(候补容量设置为10人), **When** 用户查看课程详情, **Then** 显示"候补: 5/10人"和"加入候补"按钮
7. **Given** 普通课程候补队列满员(8/8人), **When** 用户尝试加入, **Then** 提示"候补队列已满(8人),请选择其他课程"
8. **Given** VIP课程候补队列设置为5人, **When** 查看候补状态, **Then** 显示"候补: 2/5人",容量限制比普通课程更严格

---

### User Story 2 - 候补自动递补通知 (Priority: P1)

当有人取消预约或请假时,系统自动通知所有候补队列中的用户,第一个确认的用户获得名额。系统在开课前6.5小时结束所有候补，提供30分钟确认窗口，确认截止时间为开课前6小时。通知通过微信服务消息发送,10秒内送达。

**Why this priority**: 自动递补是候补系统的核心机制,直接提升运营效率和用户体验,是P1级功能。

**Independent Test**: 模拟取消预约,验证候补用户是否收到通知,抢占机制是否正确。

**Acceptance Scenarios**:

1. **Given** 课程有3人在候补队列, **When** 有用户取消预约释放名额, **Then** 系统同时向3人发送微信服务通知"XXX课程有名额了"
2. **Given** 候补用户收到通知, **When** 点击通知进入小程序, **Then** 跳转到课程详情页,显示"有名额,立即预约"按钮
3. **Given** 候补用户A点击"立即预约"并确认, **When** 系统处理, **Then** 用户A预约成功,其他候补用户的通知失效,提示"名额已被抢占"
4. **Given** 候补用户A确认预约, **When** 用户A退出候补队列, **Then** 队列中其他用户排位前移(原第2位变为第1位)
5. **Given** 所有候补用户均未在2小时内确认, **When** 超时, **Then** 名额保留给第一位候补用户,但不强制预约

---

### User Story 3 - 候补状态管理 (Priority: P1)

用户可以在"我的候补"页面查看所有候补记录,包括候补位置、课程信息、等待时间等,并支持主动取消候补操作。

**Why this priority**: 候补管理是用户体验的重要组成部分,让用户清楚了解候补状态并能主动管理。

**Independent Test**: 查看"我的候补"页面,验证记录显示、位置更新、取消操作是否正确。

**Acceptance Scenarios**:

1. **Given** 用户进入"我的"-"候补记录"页面, **When** 页面加载, **Then** 显示所有候补中的课程列表
2. **Given** 用户查看某候补记录, **When** 查看详情, **Then** 显示课程名称、候补位置(如第2位)、加入时间、预计等待时间
3. **Given** 前面有用户取消候补或成功预约, **When** 用户刷新页面, **Then** 候补位置实时更新为连续排位(如A/B/C取消后,原第4位变为第1位),不需要通知排位变化
4. **Given** 用户不想再等某课程, **When** 点击"取消候补", **Then** 弹出确认框,确认后从候补队列移除
5. **Given** 用户取消候补成功, **When** 后续用户查看, **Then** 候补位置前移,保持队列连续性

---

### User Story 4 - 补课管理 (Priority: P1)

家长在"我的课程"中查看"待补课"记录,可以选择从灵活排课中补课,或联系运营手动安排补课。请假成功后自动生成待补课记录。

**Why this priority**: 补课功能是用户关怀的重要体现,提升用户满意度,虽然频率不高但是关键功能。

**Independent Test**: 请假后,验证是否生成待补课记录,并可选择补课课程。

**Acceptance Scenarios**:

1. **Given** 用户成功请假(固定班,开课前6小时), **When** 请假成功, **Then** 系统生成一条"待补课"记录
2. **Given** 用户进入"我的课程"-"待补课"Tab, **When** 查看列表, **Then** 显示所有待补课记录(原课程名称/请假时间)
3. **Given** 用户点击某条待补课记录, **When** 进入补课选择页, **Then** 显示所有符合条件的补课课程(同等级+同类型+未满员)
4. **Given** 用户选择补课课程并确认, **When** 预约成功, **Then** 该课程占用正常名额,待补课记录状态变为"已补课",价格显示为原价划掉+显示0元(如~~¥180~~ **¥0**)
5. **Given** 用户无法找到合适的补课课程, **When** 点击"联系运营", **Then** 跳转到客服页面,提交补课需求

---

### User Story 5 - 候补截止时限与决策缓冲 (Priority: P0)

候补用户必须在开课前6.5小时内确认预约，系统提供30分钟决策缓冲期，确保候补机制的公平性和效率。

**Why this priority**: 候补截止时限是候补系统的核心机制，避免临近开课时的候补混乱，保证运营效率，必须P0实现。

**Independent Test**: 模拟不同时间点的候补通知，验证6.5小时截止和30分钟缓冲期的执行准确性。

**Acceptance Scenarios**:

1. **Given** 课程为周三19:00-20:00, **When** 周三12:30释放名额, **Then** 系统通知候补队列,用户必须在周三12:45前确认预约(6.5小时时限)
2. **Given** 候补用户在周三12:40收到通知, **When** 用户点击"立即预约", **Then** 显示"确认预约？还剩5分钟决策时间"，倒计时提醒
3. **Given** 候补用户在周三12:46尝试确认, **When** 系统检测, **Then** 提示"候补确认已过期，名额已顺位给下一位候补用户"
4. **Given** 第一位候补用户未在6.5小时内确认, **When** 周三12:45截止时间到达, **Then** 系统自动通知第二位候补用户，给予30分钟决策时间(至13:15)
5. **Given** 多位候补用户均未在各自时限内确认, **When** 最后一位候补用户也过期, **Then** 名额保留给第一位候补用户，但不强制预约，提示"请联系客服处理"
6. **Given** 用户在截止时间前1分钟开始预约流程, **When** 用户在截止时间后完成支付, **Then** 系统允许预约完成(以开始时间为准，保护用户体验)
7. **Given** 候补用户在通知中点击"暂不预约", **When** 用户操作, **Then** 立即移除该用户候补资格，顺位通知下一位候补用户

---

### User Story 6 - 补课课时差异处理 (Priority: P1)

当补课课程时长小于原课程时，系统自动计算课时差额，并提示用户补课时长不足的情况。用户可选择接受时长不足的补课或等待其他机会。

**Why this priority**: 补课课时差异处理是补课系统的核心逻辑，直接影响用户权益和课程资源管理，必须P1实现。

**Independent Test**: 测试不同时长课程的补课场景，验证课时差额计算和用户提示的准确性。

**Acceptance Scenarios**:

1. **Given** 用户请假的原课程为2小时(120分钟), **When** 查看可补课课程, **Then** 显示1.5小时(90分钟)补课课程，标注"补课时长比原课程少30分钟"
2. **Given** 用户选择1小时补课课程, **When** 查看详情, **Then** 系统提示"本课程仅1小时，比您原课程少1小时，是否确认预约？"
3. **Given** 用户确认预约时长不足的补课课程, **When** 预约成功, **Then** 生成已补课记录，但不消耗额外课时，标注"时长不足已补偿"
4. **Given** 用户预约1.5小时补课课程(原课程2小时), **When** 系统处理, **Then** 生成补课记录，同时生成"30分钟课时补偿"记录
5. **Given** 用户有课时补偿记录, **When** 查看课程列表, **Then** 显示"您有30分钟课时补偿可使用"，支持补偿课时累积使用
6. **Given** 补课课程时长大于原课程, **When** 用户预约, **Then** 正常扣费，不生成补偿记录(用户获得额外时长)
7. **Given** 用户多次请假累积课时补偿, **When** 选择补课, **Then** 支持使用补偿课时抵扣部分课程时长

---

### User Story 7 - 补课课程选择与预约 (Priority: P2)

系统提供智能补课课程筛选,用户可以根据时间、地点、教练等条件选择合适的补课课程,支持灵活的补课预约规则。

**Why this priority**: 补课课程选择是补课流程的重要环节,但依赖于候补和请假核心功能,设为P2。

**Independent Test**: 测试补课课程筛选逻辑和预约流程,验证条件匹配和名额管理。

**Acceptance Scenarios**:

1. **Given** 用户有待补课记录, **When** 进入补课选择页, **Then** 系统自动筛选符合条件的课程(同等级+同类型+未满员)
2. **Given** 用户查看补课课程列表, **When** 切换筛选条件, **Then** 支持按时间、地点、教练等维度筛选
3. **Given** 用户选择某补课课程, **When** 查看详情, **Then** 显示课程信息与原课程的匹配度说明
4. **Given** 用户确认补课预约, **When** 系统处理, **Then** 检查时间冲突,占用课程名额,更新待补课状态
5. **Given** 补课课程满员, **When** 用户尝试预约, **Then** 提示"课程已满员,是否加入候补"(调用候补功能)

---

### Edge Cases

- **并发候补处理**: 多个用户同时加入候补，如何处理顺序？ → 使用数据库事务和队列机制，按请求时间排序
- **通知发送失败**: 微信通知发送失败，如何处理？ → 记录失败日志，使用小程序内消息作为备用通知方式
- **补课冲突处理**: 用户申请的补课时间与现有预约冲突，如何处理？ → 系统检查冲突并提示用户选择其他时间
- **候补资格验证**: 用户不符合候补条件（如欠费、黑名单），如何处理？ → 系统验证资格并提示具体原因
- **补课记录有效期**: 补课记录无有效期限制，用户可以一直保留到找到合适的补课课程为止

#### 候补截止时限相关边界情况

- **临近开课释放名额**: 开课前6小时内释放名额，如何处理候补？ → 不触发候补机制，名额直接开放给所有用户先到先得
- **用户在截止时间边缘操作**: 用户在截止时间前1秒开始预约流程，如何处理？ → 以用户开始操作时间为准，允许完成预约流程
- **多轮候补通知时间重叠**: 第二轮通知时间与第一轮截止时间重叠，如何处理？ → 严格按照6.5小时规则，可能缩短后续用户的决策时间
- **候补用户网络异常**: 用户在决策期间网络中断，如何处理？ → 系统继续倒计时，过期后自动顺位，用户可联系客服手动处理
- **系统时间同步问题**: 多服务器时间不同步导致截止时间计算错误，如何处理？ → 使用统一时间服务(NTP)，记录时间戳用于审计
- **支付流程超时**: 用户在截止时间前开始支付但流程超时，如何处理？ → 支付流程独立于候补截止，以开始预约时间为准保护用户
- **候补队列清空**: 所有候补用户都过期后名额如何处理？ → 保留给第一位候补用户但不强制，运营人员可手动分配给其他用户

#### 补课课时差异相关边界情况

- **补偿课时有效期**: 补偿课时是否有有效期限制？ → 建议3个月有效期，过期自动清理，防止累积过多
- **补偿课时转让**: 补偿课时是否可以转让给其他学员？ → 不允许转让，仅限原学员本人使用
- **大额补偿处理**: 用户累积大量补偿课时(如超过5小时)如何处理？ → 系统提醒用户使用，运营人员可主动联系安排补课
- **补偿课时退款**: 补偿课时是否可以退款？ → 不支持退款，仅限转换为补课或同价值课程
- **补课课程取消**: 用户已预约的补课课程被取消，补偿如何处理？ → 恢复原有补偿记录，允许重新选择补课
- **课程时长计算误差**: 课程实际时长与计划时长不一致，如何处理？ → 以实际签到签退时长为准，自动调整补偿计算
- **补偿使用优先级**: 用户有补偿和正常课时，预约时使用哪个？ → 优先使用正常课时，补偿仅在补课或余额不足时使用

---

## Functional Requirements *(mandatory)*

### Core Requirements

- **FR-001**: 系统必须支持候补队列,每个课程最多8人候补
- **FR-002**: 系统必须按先到先得(FIFO)原则管理候补队列,但名额锁定以确认时间为准
- **FR-003**: 系统必须在取消预约/请假后10秒内通知所有候补用户
- **FR-004**: 系统必须通过微信服务通知发送候补通知(需申请微信模板消息权限)
- **FR-005**: 系统必须在候补用户确认预约后,自动将其从候补队列移除
- **FR-006**: 系统必须支持候补用户主动取消候补
- **FR-007**: 系统必须在请假成功后生成"待补课"记录
- **FR-008**: 系统必须筛选符合补课条件的课程(同等级+同类型+未满员)
- **FR-009**: 系统必须在补课时占用正常名额(防止班级拥堵)
- **FR-010**: 系统必须支持"联系运营"功能,提交补课需求到后台

#### 候补容量管理相关（FR-043）

- **FR-043**: 系统必须实施动态候补容量管理:每个课程设置独立的候补队列容量限制(默认8人),支持不同课程类型的差异化容量设置
- **FR-044**: 系统必须在用户加入候补前检查该课程的候补队列容量,队列满员时提示"候补队列已满"
- **FR-045**: 系统必须显示当前候补队列的容量状态(如"候补: 5/8人"),让用户清楚排队情况
- **FR-046**: 系统必须支持运营人员根据课程热门程度和类型调整候补容量限制
- **FR-047**: 系统必须在候补用户成功预约后,实时更新候补队列容量计数
- **FR-048**: 系统必须在候补用户主动取消候补后,立即释放容量供其他用户加入

#### 候补截止时限相关

- **FR-011**: 系统必须实施6.5小时候补确认时限规则(开课前6.5小时必须确认)
- **FR-012**: 系统必须为每位候补用户提供30分钟决策缓冲期(从通知时间起计算)
- **FR-013**: 系统必须在候补通知中显示明确的截止时间和倒计时提醒
- **FR-014**: 系统必须在候补用户过期后自动顺位通知下一位候补用户
- **FR-015**: 系统必须在用户开始预约流程后，允许其完成预约(以开始时间为准，保护用户体验)
- **FR-016**: 系统必须支持用户主动放弃候补机会，立即顺位下一位用户
- **FR-017**: 系统必须在所有候补用户均过期后，保留名额给第一位用户但不强制预约

#### 补课课时差异处理相关

- **FR-026**: 系统必须比较补课课程与原课程的时长差异，自动计算课时差额
- **FR-027**: 系统必须在补课课程详情页显示时长差异提示（补课时长比原课程少X分钟）
- **FR-028**: 系统必须支持用户确认预约时长不足的补课课程，并标注"时长不足已补偿"
- **FR-029**: 系统必须自动生成课时补偿记录（当补课时长小于原课程时）
- **FR-030**: 系统必须支持课时补偿累积使用，多个补偿记录可以合并使用
- **FR-031**: 系统必须在用户预约补课时显示可用补偿课时余额
- **FR-032**: 系统必须支持补课时长大于原课程的情况（用户获得额外时长，不额外扣费）

### Data Requirements

- **FR-018**: 系统必须存储候补记录:候补ID/档案ID/课程ID/加入时间/状态(候补中/已确认/已取消/已过期)
- **FR-019**: 系统必须存储补课记录:补课ID/原预约ID/档案ID/请假时间/状态(待补课/已补课)
- **FR-020**: 系统必须记录候补通知发送记录:通知ID/候补ID/发送时间/响应截止时间/状态(待响应/已确认/已过期/已放弃)

#### 候补容量管理数据字段（FR-043）

- **FR-049**: 系统必须存储课程候补容量设置:课程ID/候补容量上限/当前候补人数/容量使用率
- **FR-050**: 系统必须记录候补队列容量变更历史:变更时间/课程ID/原容量/新容量/变更原因/操作人
- **FR-051**: 系统必须存储不同课程类型的默认候补容量:课程类型/默认容量/最大容量/最小容量
- **FR-052**: 系统必须监控候补队列满员情况,为运营人员提供容量优化建议

#### 候补截止时限数据字段

- **FR-021**: 系统必须存储候补通知的截止时间(notification_deadline):基于通知发送时间+30分钟计算
- **FR-022**: 系统必须记录候补用户的响应时间(response_time):用户点击"立即预约"的时间戳
- **FR-023**: 系统必须记录候补流程的开始时间(flow_start_time):用户开始预约操作的时间
- **FR-024**: 系统必须存储候补过期原因(expiration_reason):自动过期/用户放弃/系统异常
- **FR-025**: 系统必须记录候补顺位通知的次数(notification_round):第几轮候补通知

#### 补课课时差异数据字段

- **FR-033**: 系统必须存储原课程时长信息(original_duration):原课程的分钟数
- **FR-034**: 系统必须存储补课课程时长信息(makeup_duration):补课课程的分钟数
- **FR-035**: 系统必须计算并存储课时差额(duration_difference):原课程时长-补课课程时长
- **FR-036**: 系统必须存储课时补偿记录:补偿ID/档案ID/原预约ID/补偿时长/状态(待使用/已使用)
- **FR-037**: 系统必须记录补偿课时使用情况:使用时间/使用预约ID/剩余补偿时长
- **FR-038**: 系统必须存储补课完成标记:是否为完整补课/部分补课/超额补课

### Integration Requirements

- **FR-014**: 系统必须监听MVP-2A的取消预约事件,触发候补通知
- **FR-015**: 系统必须为MVP-2C私教系统提供候补功能接口
- **FR-016**: 系统必须支持课程状态变更的异步处理机制

### Key Entities

- **waitlist**: 候补实体，记录用户的候补信息
  - 核心属性: id, user_id, course_id, schedule_id, status, join_time, position
  - 业务规则: 按加入时间排序，支持优先级设置和资格验证

- **waitlist_notification**: 候补通知实体，记录通知发送和响应情况
  - 核心属性: id, waitlist_id, notification_type, sent_time, response_deadline, response_time, status, notification_round
  - 业务规则: 支持多种通知方式，记录完整的通知生命周期，包含30分钟决策期限管理

- **waitlist_flow**: 候补流程实体，记录用户的预约流程时间戳
  - 核心属性: id, waitlist_notification_id, flow_start_time, flow_completion_time, expiration_reason
  - 业务规则: 保护用户预约流程，以开始时间为准判断是否允许完成预约

- **makeup_class**: 补课课程实体，专门的补课课程安排
  - 核心属性: id, original_course_id, schedule_id, max_capacity, current_bookings
  - 业务规则: 继承普通课程属性，增加补课特定的业务规则

- **makeup_booking**: 补课预约实体，记录用户的补课预约
  - 核心属性: id, user_id, original_booking_id, makeup_class_id, status, booking_time, original_duration, makeup_duration, duration_difference, completion_type
  - 业务规则: 关联原缺席记录，支持补课状态追踪，记录课时差异信息

- **makeup_voucher**: 补课券实体，记录用户获得的补课券
  - 核心属性: id, user_id, profile_id, source_booking_id, issue_date, expiry_date, status, used_booking_id, notes
  - 业务规则: 自动生成补课券，30天有效期，1:1使用比例，严格管理

- **compensation_usage**: 补偿使用记录实体，记录课时补偿的使用情况
  - 核心属性: id, compensation_id, booking_id, used_minutes, remaining_minutes, usage_time
  - 业务规则: 记录补偿课时使用明细，支持部分使用和累积计算

---

## Success Criteria *(mandatory)*

- **SC-001**: 候补加入成功率>99%,候补队列排位准确率100%
- **SC-002**: 名额释放后,候补通知在10秒内送达,送达率>95%
- **SC-003**: 候补用户点击通知进入小程序,跳转准确率100%
- **SC-004**: 候补抢名额成功率100%(第一个确认者必定成功)
- **SC-005**: 补课记录生成准确率100%(请假成功必定生成)
- **SC-006**: 补课课程筛选准确率100%(仅显示符合条件的课程)
- **SC-007**: 补课名额占用准确率100%(补课时正常名额-1)

#### 候补截止时限成功标准

- **SC-008**: 6.5小时候补截止时限执行准确率100%(系统严格按开课前6.5小时计算截止时间)
- **SC-009**: 30分钟决策缓冲期计算准确率100%(每位候补用户获得准确的通知时间+30分钟窗口)
- **SC-010**: 候补过期自动顺位成功率>99%(过期用户自动移除，下一位用户及时收到通知)
- **SC-011**: 候补倒计时显示准确率100%(用户看到的倒计时与服务器时间同步)
- **SC-012**: 临近开课不触发候补机制准确率100%(开课前6小时内释放名额不触发候补)
- **SC-013**: 用户预约流程保护成功率100%(用户在截止时间前开始预约可完成流程)
- **SC-014**: 候补队列清空处理成功率>99%(所有用户过期后系统正确处理名额归属)

#### 补课课时差异处理成功标准

- **SC-015**: 课时差异计算准确率100%(系统准确计算原课程与补课课程的时长差)
- **SC-016**: 补课时长提示显示准确率100%(用户看到的时长差异提示准确无误)
- **SC-017**: 课时补偿自动生成成功率>99%(时长不足的补课自动生成补偿记录)
- **SC-018**: 补偿课时累积使用成功率>99%(多个补偿记录可正确合并使用)
- **SC-019**: 补偿课时余额显示准确率100%(用户看到的可用补偿余额准确)
- **SC-020**: 补课完成标记准确率100%(完整补课/部分补课/超额补课标记正确)
- **SC-021**: 补偿使用记录追踪准确率100%(补偿课时使用明细完整记录)

---

## Assumptions

- 假设微信消息推送服务稳定可靠，能够及时送达用户
- 假设用户会及时查看和响应候补通知（15分钟内）
- 假设运营人员会合理安排补课课程，确保有足够的补课资源
- 假设用户理解候补和补课的规则，配合系统安排

---

## Out of Scope (MVP-2B 不实现)

- ❌ 候补优先级购买（留到后期）
- ❌ 补课费用计算（留到MVP-3支付系统）
- ❌ 补课课程评价功能（留到后期）
- ❌ 候补统计分析功能（留到运营后台）
- ❌ 自动推荐补课课程（留到后期）
- ❌ 补课转让功能（留到后期）

---

## Open Questions

1. **[RESOLVED]** 候补确认的时间限制是多少？15分钟是否合适？
   - **已确定**: 6.5小时候补截止时限 + 30分钟决策缓冲期，即开课前6.5小时为最后通知时间

2. **[NEEDS CLARIFICATION]** 用户每月最多可以申请多少次补课？
   - 建议: 每月最多2次补课，超出需要运营人员审核

3. **[NEEDS CLARIFICATION]** 候补通知是否需要同时发送微信消息和小程序内消息？
   - 建议: 优先发送微信消息，失败时使用小程序内消息作为备用

4. **[NEEDS CLARIFICATION]** 补课课程是否可以和普通课程一样加入候补？
   - 建议: 补课课程也可以加入候补，但候补规则与普通课程略有不同

5. **[NEEDS CLARIFICATION]** 用户取消候补后，重新加入时是否从队列末尾开始？
   - 建议: 是的，取消后重新加入从末尾开始，确保公平性

6. **[NEW]** 系统时间同步精度要求？候补截止时间计算需要多高精度？
   - 建议: 使用服务器统一时间(NTP)，精确到秒级，记录完整时间戳用于审计

7. **[NEW]** 支付流程时间保护范围？用户开始支付后最长保护时间？
   - 建议: 以用户点击"立即预约"时间为准，保护整个支付预约流程，无硬性时间限制

---

## Integration Points

### Dependencies on MVP-2A
- **课程数据管理**: 需要MVP-2A的课程信息和预约状态
- **用户身份系统**: 需要MVP-1的用户登录和档案管理
- **预约系统**: 需要MVP-2A的预约数据和状态管理

### Dependencies on Future MVPs
- **支付系统**: MVP-3将为付费补课课程提供支付功能
- **运营后台**: MVP-5将提供候补和补课的统计分析
- **评价系统**: 后续将为补课课程添加评价功能

### Technical Dependencies
- **微信小程序**: 前端展示和用户交互
- **后端API**: 业务逻辑和数据管理
- **微信消息推送**: 通知发送服务
- **定时任务**: 定期检查和处理候补队列

---

**创建人**: [产品经理]
**最后更新**: 2025-10-31
**版本**: v1.2.0
**状态**: Draft
**更新内容**: 整合最终需求 - 候补截止时限与决策缓冲机制(6.5小时规则+30分钟缓冲期) + 补课课时差异处理系统