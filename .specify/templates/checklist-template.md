# 质量检查清单模板

**功能**: [feature-name]
**版本**: [version]
**创建日期**: [DATE]

## 需求质量检查

### 用户故事完整性
- [ ] 每个用户故事都有明确的优先级 (P1, P2, P3)
- [ ] 每个用户故事都有独立的测试方法
- [ ] 每个用户故事都有完整的验收场景 (Given/When/Then)
- [ ] 边界情况都已考虑并有处理方案

### 功能需求完整性
- [ ] 所有功能需求都有FR-XXX编号
- [ ] 每个需求都是具体且可测试的
- [ ] 需求覆盖了所有用户故事
- [ ] 没有模糊或歧义的描述

### 成功标准可衡量性
- [ ] 每个成功标准都有具体指标
- [ ] 所有指标都是可量化的
- [ ] 标准覆盖了关键业务价值
- [ ] 有明确的验收方法

### 范围明确性
- [ ] 明确标记了不实现的功能
- [ ] 范围边界清晰无歧义
- [ ] 与其他MVP的依赖关系明确

## 设计质量检查

### 技术选型合规性
- [ ] 遵循宪法Principle 1 (简化优先)
- [ ] 技术栈符合AI Coding友好原则
- [ ] 没有引入不必要的复杂性

### 数据完整性
- [ ] 遵循宪法Principle 2 (数据完整性至上)
- [ ] 关键业务操作使用事务保护
- [ ] 数据模型设计合理
- [ ] 有适当的数据验证机制

### API设计合规性
- [ ] 遵循宪法Principle 4 (API优先架构)
- [ ] API设计符合RESTful规范
- [ ] 响应格式统一
- [ ] 有适当的错误处理

### 安全性考虑
- [ ] 遵循宪法Principle 8 (安全与合规)
- [ ] 用户数据隔离机制完善
- [ ] 敏感操作有权限控制
- [ ] 输入验证和过滤完善

## 实现质量检查

### 代码质量
- [ ] 遵循宪法Principle 3 (可维护性与可读性)
- [ ] 代码结构清晰分层
- [ ] 函数和类的职责单一
- [ ] 有充分的注释说明

### 测试覆盖
- [ ] 遵循宪法Principle 7 (测试驱动的数据操作)
- [ ] 关键业务逻辑有单元测试
- [ ] API端点有集成测试
- [ ] 用户场景有端到端测试

### 性能考虑
- [ ] 数据库查询优化
- [ ] 适当的缓存策略
- [ ] 前端加载性能优化
- [ ] API响应时间合理

## 文档质量检查

### 规格文档
- [ ] 用户故事描述清晰
- [ ] 功能需求具体明确
- [ ] 成功标准可衡量
- [ ] 边界情况考虑充分

### 计划文档
- [ ] 技术方案合理可行
- [ ] 数据库设计规范
- [ ] API契约清晰
- [ ] 风险评估充分

### 任务文档
- [ ] 任务分解合理
- [ ] 依赖关系明确
- [ ] 完成标准具体
- [ ] 时间估算合理

---

## DRY与代码质量检查 *(Principle 10-18)*

### 代码复用检查 (Principle 10)
- [ ] 所有工具函数已抽取到`/shared/utils/`目录
- [ ] 无重复定义的数据库模型（通过`grep "CREATE TABLE"`检查）
- [ ] API响应格式统一使用`shared/utils/apiResponse.js`
- [ ] 无硬编码魔法数字（通过`eslint no-magic-numbers`检查）
- [ ] 小程序组件库已复用（列出复用组件清单）
- [ ] 代码重复率检查通过（`npm run dry:check`，<5%）

### 模块化与单一职责检查 (Principle 11)
- [ ] Controller文件只处理HTTP请求/响应，不含业务逻辑
- [ ] Service层函数<50行代码，职责单一
- [ ] Model文件只定义数据结构，不含业务逻辑
- [ ] 函数复杂度<10（通过ESLint complexity检查）
- [ ] 每个文件只有一个主要职责

### 依赖注入与解耦检查 (Principle 12)
- [ ] Controller不直接require业务模块
- [ ] 使用依赖注入容器管理依赖
- [ ] 配置通过环境变量或config.js外部化
- [ ] 模块间依赖关系清晰，无循环依赖

### 错误处理与日志检查 (Principle 13)
- [ ] 所有async函数包含try-catch
- [ ] 使用`shared/utils/logger.js`统一日志格式
- [ ] 错误信息使用`shared/constants/errorCodes.js`标准错误码
- [ ] 敏感信息已脱敏处理
- [ ] 无console.log在生产代码中

### 数据一致性检查 (Principle 14)
- [ ] 跨表操作使用数据库事务保护
- [ ] 涉及金额操作强制事务
- [ ] 使用乐观锁防止并发冲突
- [ ] 关键操作支持幂等性

### API版本控制检查 (Principle 15)
- [ ] API路径包含版本前缀`/api/v1/`
- [ ] 响应字段只增不减
- [ ] 废弃字段标记deprecated
- [ ] API文档自动生成并更新

### 测试覆盖率检查 (Principle 16)
- [ ] 整体测试覆盖率>80%（`npm test`检查）
- [ ] 核心业务逻辑覆盖率=100%
- [ ] 共享模块测试覆盖率>90%
- [ ] 单元测试、集成测试、端到端测试完整

### 代码审查与Lint检查 (Principle 17)
- [ ] ESLint检查无error（`npm run lint`）
- [ ] Prettier格式检查通过（`npm run format:check`）
- [ ] 函数包含JSDoc注释
- [ ] Git提交信息规范
- [ ] 代码审查已完成

### 文档规范检查 (Principle 18)
- [ ] 所有导出函数包含JSDoc注释
- [ ] JSDoc包含参数、返回值、异常说明
- [ ] 复杂算法有注释说明
- [ ] README文档完整且最新
- [ ] API文档自动生成

---

## 合规性检查

### 宪法原则遵循
- [ ] Principle 1: 简化优先 ✅
- [ ] Principle 2: 数据完整性 ✅
- [ ] Principle 3: 可维护性与可读性 ✅
- [ ] Principle 4: API优先架构 ✅
- [ ] Principle 5: 增量交付 ✅
- [ ] Principle 6: 以用户为中心 ✅
- [ ] Principle 7: 测试驱动的数据操作 ✅
- [ ] Principle 8: 安全与合规 ✅
- [ ] Principle 9: 迁移与集成支持 ✅
- [ ] Principle 10: DRY - 代码复用与禁止重复 ✅
- [ ] Principle 11: 单一职责与模块化 ✅
- [ ] Principle 12: 依赖注入与解耦 ✅
- [ ] Principle 13: 强制错误处理与日志规范 ✅
- [ ] Principle 14: 数据库事务与一致性保证 ✅
- [ ] Principle 15: API版本控制与向后兼容 ✅
- [ ] Principle 16: 测试优先与覆盖率要求 ✅
- [ ] Principle 17: 代码审查与Lint强制执行 ✅
- [ ] Principle 18: 文档即代码与注释规范 ✅

### MVP阶段一致性
- [ ] 符合当前MVP的范围定义
- [ ] 与前序MVP的依赖关系明确
- [ ] 为后续MVP预留扩展空间
- [ ] 纵向切片策略得到体现

## 最终验收检查

### 功能完整性
- [ ] 所有用户故事都已实现
- [ ] 所有功能需求都已满足
- [ ] 所有成功标准都已达成
- [ ] 边界情况处理正确

### 质量标准
- [ ] 代码质量达到团队标准
- [ ] 测试覆盖率达到要求
- [ ] 性能指标符合预期
- [ ] 安全检查全部通过

### 文档完整性
- [ ] 所有必要文档都已创建
- [ ] 文档内容准确且最新
- [ ] 文档格式符合模板要求
- [ ] 技术文档对后续开发友好

## 检查结果

### 通过项目
- [ ] 需求质量检查 ✅
- [ ] 设计质量检查 ✅
- [ ] 实现质量检查 ✅
- [ ] 文档质量检查 ✅
- [ ] DRY与代码质量检查 ✅
- [ ] 合规性检查 ✅
- [ ] 最终验收检查 ✅

### 问题记录
- [发现问题1]: [详细描述] - [解决方案]
- [发现问题2]: [详细描述] - [解决方案]
- [发现问题3]: [详细描述] - [解决方案]

### 总体评估
- **质量评级**: [A/B/C/D]
- **建议**: [改进建议]
- **状态**: [通过/有条件通过/不通过]

---

**检查人**: [Reviewer Name]
**检查日期**: [Review Date]
**版本**: [Version]